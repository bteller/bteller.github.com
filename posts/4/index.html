
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brad Teller</title>
  <meta name="author" content="Brad Teller">

  
  <meta name="description" content="I know I was going to try and put this out weekly, but I was a little busy, then simply not feeling very motivated to post to the blog. Hopefully I& &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://bradteller.com/posts/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Brad Teller" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Brad Teller</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscribe" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 13.310204,73.332654 C 5.967347,73.332654 0,79.322448 0,86.621428 c 0,7.338776 5.967347,13.262246 13.310204,13.262246 7.370408,0 13.328572,-5.92245 13.328572,-13.262246 0,-7.29898 -5.958164,-13.288774 -13.328572,-13.288774 z M 0.01530612,33.978572 V 53.143878 C 12.493878,53.143878 24.229592,58.02347 33.068368,66.865306 41.894898,75.685714 46.767346,87.47449 46.767346,100 h 19.25 C 66.017346,63.592858 36.4,33.979592 0.01530612,33.978572 l 0,0 z M 0.03877552,0 V 19.17449 C 44.54796,19.17551 80.77551,55.437756 80.77551,100 H 100 C 100,44.87653 55.15102,0 0.03877552,0 z"></path></svg></a></li>
  
</ul>
  
  
  
  
  
<ul class="subscribe">
  <li><a href="https://github.com/bteller" rel="subscribe-github" title="@bteller on GitHub" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 50,0 C 22.385714,0 0,22.385714 0,50 0,77.614286 22.385714,100 50,100 77.614286,100 100,77.614286 100,50 100,22.385714 77.614286,0 50,0 z m 29.692858,79.692858 c -3.859184,3.859182 -8.351022,6.887754 -13.35,9.00306 -1.27041,0.536736 -2.560204,1.009184 -3.867348,1.415306 v -7.493878 c 0,-3.938774 -1.35102,-6.835714 -4.053062,-8.690816 1.692858,-0.163264 3.24694,-0.390816 4.663266,-0.683672 1.416326,-0.292858 2.913266,-0.716328 4.491838,-1.27041 1.57857,-0.55408 2.994896,-1.213264 4.247958,-1.97755 1.253062,-0.765306 2.458164,-1.758164 3.613266,-2.978572 1.155102,-1.220408 2.12449,-2.604082 2.905102,-4.15 0.780612,-1.545918 1.4,-3.40204 1.855102,-5.566326 0.455102,-2.164286 0.683674,-4.54898 0.683674,-7.153062 0,-5.045918 -1.643878,-9.341836 -4.931634,-12.890816 C 77.44796,33.35 77.285714,29.10204 75.463266,24.512244 l -1.22143,-0.145918 c -0.845918,-0.09796 -2.368366,0.260204 -4.565306,1.07449 -2.196938,0.814286 -4.663264,2.14796 -7.396938,4.004082 -3.87449,-1.07449 -7.893878,-1.611224 -12.061224,-1.611224 -4.19898,0 -8.203062,0.536734 -12.012246,1.611224 -1.72449,-1.17245 -3.361224,-2.139796 -4.907142,-2.905102 C 31.753062,25.77449 30.516326,25.254082 29.587756,24.97653 28.660204,24.7 27.79796,24.528572 27,24.463266 c -0.79796,-0.0653 -1.310204,-0.08062 -1.537756,-0.04898 -0.22755,0.03164 -0.390816,0.0653 -0.487754,0.09796 -1.82347,4.62245 -1.985714,8.87143 -0.487756,12.743878 -3.287754,3.54796 -4.931632,7.844898 -4.931632,12.890816 0,2.604082 0.227552,4.988776 0.683674,7.153062 0.456122,2.164286 1.07449,4.020408 1.855102,5.566326 0.780612,1.545918 1.75,2.929592 2.905102,4.15 1.155102,1.220408 2.360204,2.213266 3.613264,2.978572 1.253062,0.766326 2.669388,1.42449 4.24796,1.97755 1.578572,0.554082 3.07551,0.976532 4.491836,1.27041 1.416328,0.292856 2.970408,0.521428 4.663266,0.683672 -2.669388,1.82347 -4.004082,4.720408 -4.004082,8.690816 v 7.639796 C 36.536734,89.818368 35.083674,89.3 33.656122,88.695918 c -4.99898,-2.115306 -9.490816,-5.143878 -13.35,-9.00306 -3.859184,-3.859184 -6.887754,-8.351022 -9.00306,-13.35 C 9.1163263,61.171428 8.0071428,55.67347 8.0071428,50 c 0,-5.67347 1.1091835,-11.171428 3.2969392,-16.342858 2.115306,-4.998978 5.143878,-9.490816 9.00306,-13.35 3.859184,-3.859182 8.351022,-6.887754 13.35,-9.00306 C 38.828572,9.1163266 44.32653,8.0071428 50,8.0071428 c 5.67347,0 11.171428,1.1091838 16.342858,3.2969392 5,2.115306 9.490816,5.143878 13.35,9.00306 3.859182,3.859184 6.887754,8.351022 9.00306,13.35 2.186736,5.17245 3.295918,10.67041 3.295918,16.342858 0,5.672448 -1.109182,11.171428 -3.296938,16.342858 -2.115306,4.998978 -5.143878,9.490816 -9.00204,13.35 l 0,0 z"></path></svg></a></li>
</ul>
  
  
  
<ul class="subscribe">
  <li><a href="https://twitter.com/bradteller" rel="subscribe-twitter" title="@bradteller on Twitter" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 512 512"><path class="social" d="M0.001,334.932c33.327,30.816,118.891,59.981,188.517-8.271c-12.52,1.955-22.972-0.416-30.913-8.269
  c-7.531-7.465-7.945-15.182-3.914-22.202c3.275-5.725,10.184-9.741,16.977-13.934c-12.323,2.285-22.829,1.095-32.218-3.706
  c-12.604-6.444-24.863-13.228-28.3-27.207c7.71-8.112,16.28-15.359,34.831-12.627c-17.45-5.83-33.087-13.429-44.41-24.815
  c-11.028-11.091-12.163-18.302-13.932-26.996c9.632-3.567,19.688-5.421,30.478-4.353c-24.397-12.476-34.757-29.63-40.487-48.325
  c-1.731-5.652-2.044-11.03-1.31-16.545c98.826,37.305,145.11,64.109,170.662,89.251c11.496-30.589,38.3-99.868,78.371-123.646
  c0.191,3.77-1.309,7.837-4.357,12.189c11.863-6.609,21.125-17.188,37.445-16.98c-1.879,7.723-7.279,13.904-17.85,17.854
  c10.662-4.084,21.463-7.545,32.65-9.578c10.375-1.881,10.229,6.304,4.355,10.444c-11.916,8.412-24.578,9.456-37.006,13.498
  c38.105,0.949,69.266,18.994,93.604,58.343c8.088,13.074,13.52,26.149,14.807,40.487c16.254,4.563,32.426,5.494,48.76,2.61
  c4.475-0.796,8.645-1.63,12.627-3.482c-6.354,9.529-13.686,17.356-23.947,20.899c-9.811,3.387-19.637,6.688-30.473,6.968
  c17.641,6.675,37.082,7.045,57.033,5.659c-24.402,23.486-43.08,22.922-61.824,22.642c-8.221,34.703-25.025,69.315-60.52,101.005
  c-46.559,41.569-96.678,61.397-148.457,65.742c-48.552,4.07-95.488,3.512-146.726-20.464
  C56.486,393.349,24.648,368.884,0.001,334.932L0.001,334.932z"/></svg></a></li>
</ul>
  
  
  
  
  
  
    
      <form action="https://www.google.com/search" method="get">
        <fieldset role="search">
          <input type="hidden" name="sitesearch" value="bradteller.com" />
    
          <input class="search" type="text" name="q" results="0" placeholder="Search"/>
        </fieldset>
      </form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/02/15/the-weekly-bookshelf/">The Weekly Bookshelf</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-02-15T00:00:00-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I know I was going to try and put this out weekly, but I was a little busy, then simply not feeling very motivated to post to the blog. Hopefully I&rsquo;m over all that now. Here is the most recent installment.</p>

<ul>
<li><a href="http://www.amazon.com/Programming-Entity-Framework-ebook/dp/B0043D2DS2/ref=sr_1_2?ie=UTF8&amp;qid=1327544440&amp;sr=8-2">Programming Entity Framework, Second Edition</a> by Julie Lerman - I found this book to be well written and informative. I read it, for the most part, cover to cover. I did gloss over certain areas of the book, scanning the text for good tidbits of information while leaving other areas covered by the text for later exploration if and when the time comes when I might require that particular knowledge. I did find some of the code examples to be lacking in their thorough coverage of real world implementation, but I very rarely come across code examples that I feel are truly comprehensive. This book covers everything from the basics of Entity Framework and concepts on up through advanced topics such as dealing with an entities connected state and how to manage that state within the context.</li>
<li><a href="http://www.amazon.com/Clean-Coder-Professional-Programmers-ebook/dp/B0050JLC9Y/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1327544811&amp;sr=1-1">The Clean Coder: A Code of Conduct for Professional Programmers</a> by Robert C. Martin - Wow, this one was actually very entertaining. The use of dialog to drive home his points was excellent. This is a book I would recommend for anyone working in the IT industry, not just computer programmers. While some of the topics are geared more to developers, there is a lot to be gleaned from the text about how to be a &ldquo;professional&rdquo; within the IT field that anyone could benefit from. I will say that the man sure did like to repeat himself. How many times do we need to know where he  was working and what he did wrong? I&rsquo;m grateful for the story sharing though, however repetitive it might have been in places, for the simple fact that it made me feel a little better about some of my own blunders. We all stumble along the way, it is the mark of a true &ldquo;professional&rdquo;, and really just the mature adult, when you can learn from your mistakes and allow them to make you that much stronger in your field. Definitely well worth a read. Can I say 5 &frac12; stars? But seriously, I&rsquo;m considering purchasing this book because it is something I know I&rsquo;ll want to pick up and read again to get my head back in the game and regain my focus.</li>
<li><a href="http://www.amazon.com/Professional-ASP-NET-Design-Patterns-ebook/dp/B0045JL68W/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1327545108&amp;sr=1-1">Professional ASP.Net Design Patterns</a> by Scott Millett - I had started reading it a few months ago but never really got into it. The code samples are a little hard to follow in places but you can download the full code off of <a href="http://www.wrox.com/">www.wrox.com</a>. Other than that, anybody working a .Net shop interested in learning more about practical applications of design patters, this is a good place to start.</li>
</ul>


<p>And, as always, here is a list of blog posts, and other assorted pages, that I enjoyed for one reason or another.</p>

<ul>
<li><a href="http://theoatmeal.com/horrible">http://theoatmeal.com/horrible</a> - Some of these are just down right hilarious.</li>
<li><a href="http://zenhabits.net/spiral/">http://zenhabits.net/spiral/</a> - I read this a while ago but thought given this is the first month of a new year you might be interested.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/25/mvc-html-helper-generate-secure-url/">MVC Html Helper: Generate Secure URL</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-01-25T00:00:00-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>Have you ever wanted to generate action links to your controller and have them be prefixed with the correct protocol? This was missing from the core set of extensions, at least from my poking around. I&rsquo;m not sure if I should have taken it&rsquo;s absence as an indication that perhaps there is another approach that should be taken. We&rsquo;ve all been told since the beginning that SSL communications should be reserved for times when encrypted communications is an absolute requirement, such as when authenticating a user, displaying a customers banking information, or accepting a payment method. While there is always going to be some level of overhead to these communications, in some situations it may be negligible.</p>

<p>Regardless of that the requirement here is quite clear. I have action methods on my controller that I&rsquo;m decorating with the RequireHttps attribute. When I create the equivalent of an Html.ActionLink to them I want the protocol to be automatically specified correctly, that way secure pages will be routed of HTTPS. The following is an extension method to help make life a little easier dealing with that requirement.</p>

<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">static</span> <span class="n">MvcHtmlString</span> <span class="nf">GenerateUrl</span><span class="p">(</span><span class="k">this</span> <span class="n">HtmlHelper</span> <span class="n">helper</span><span class="p">,</span> <span class="kt">string</span> <span class="n">linkText</span><span class="p">,</span> <span class="kt">string</span> <span class="n">actionName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">controllerName</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="n">protocol</span> <span class="p">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>

    <span class="kt">var</span> <span class="n">c</span> <span class="p">=</span> <span class="n">ControllerBuilder</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">GetControllerFactory</span><span class="p">().</span><span class="n">CreateController</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="n">ViewContext</span><span class="p">.</span><span class="n">RequestContext</span><span class="p">,</span> <span class="n">controllerName</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">cd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ReflectedControllerDescriptor</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">GetType</span><span class="p">());</span>
    <span class="kt">var</span> <span class="n">ad</span> <span class="p">=</span> <span class="n">cd</span><span class="p">.</span><span class="n">FindAction</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="n">ViewContext</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">ControllerContext</span><span class="p">,</span> <span class="n">actionName</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ad</span><span class="p">.</span><span class="n">GetCustomAttributes</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">RequireHttpsAttribute</span><span class="p">),</span> <span class="k">false</span><span class="p">).</span><span class="n">Count</span><span class="p">()</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">protocol</span> <span class="p">=</span> <span class="s">&quot;https&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">helper</span><span class="p">.</span><span class="n">ActionLink</span><span class="p">(</span><span class="n">linkText</span><span class="p">,</span> <span class="n">actionName</span><span class="p">,</span> <span class="n">controllerName</span><span class="p">,</span> <span class="n">protocol</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/20/programming-nightmares/">Programming Nightmares</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-01-20T00:00:00-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>It&rsquo;s been a while now that my all I&rsquo;ve been watching all my television shows on <a href="http://www.hulu.com/">Hulu</a> and one of the shows I subscribe to is Kitchen Nightmares. Seeing the latest episode in my queue reminded me of a production I watched over at <a href="http://www.tekpub.com/">TekPub</a> called &ldquo;<a href="http://tekpub.com/productions/ft_triage_oren">Full Throttle: Triage with Ayende Rahien</a>&rdquo;. This was an interesting production because they took a business problem and showed how someone would address that problem in code. What it got me wondering is if it wouldn&rsquo;t be possible to do something similar to Kitchen Nightmares, but with large and unruly code-bases, and how a skilled developer would go through the refactoring process to bring them back under control, the same way that Gordon Ramsey does in the kitchen.</p>

<p>To date I&rsquo;ve purchased a single month subscription to TekPub, twice. I&rsquo;m not a recurring subscriber because I find the quality of the content to be greatly varied. It misses home for me where my core interests are concerned, and I find I can glean more from reading books and blog posts than I can from this service. That isn&rsquo;t to say that I find the content to be without value, I think it all depends on your level of familiarity with certain technologies and languages, and I definitely would recommend the purchase of certain productions, but the content isn&rsquo;t consistently of interest to me to warrant the monthly subscription rate. Again though, I really enjoyed this Full Throttle production and would love to see more like it.</p>

<p>To that end, would it be possible to spawn a &ldquo;Programming Nightmares&rdquo; production? Would people out there be receptive of the idea? Would they be open to having one of these gurus of our craft come into their world and dissect there code-base? To me this type of production would be invaluable. We constantly hear criticisms of technologies and patterns, have pitfalls identified, and sometimes we receive recommendations as to how we might do things better, but those recommendations are hardly if ever comprehensive. Is &ldquo;Programming Nightmares&rdquo; what has been missing? Is TekPub, or any other similar service, up to the challenge?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/18/the-weekly-bookshelf/">The Weekly Bookshelf</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-01-18T00:00:00-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I am going to try something out which I&rsquo;m calling &ldquo;The Weekly Bookshelf&rdquo;. This is going to be a list of what I&rsquo;m currently reading, or have read over the course of the past week. I&rsquo;m only going to identify blog posts that really I found enjoyable or really resonated with me. Please feel free to comment away.</p>

<h3>Books I&rsquo;m done with:</h3>

<ul>
<li>&ldquo;Witch and Wizard&rdquo; by James Patterson - I had read &ldquo;Don&rsquo;t Blink&rdquo; which I really enjoyed, but this one wasn&rsquo;t quite as enjoyable. It was a really easy read, Amazon has its reading level listed as ages 10 and up if that tells you anything. Seeing that never deters me though, I devoured the Harry Potter books so I thought it was worth a shot. The jury is still out as to whether or not I&rsquo;ll read the other books in this series.</li>
<li>Sorry to report that I haven&rsquo;t finished reading any technical books this past week.</li>
</ul>


<h3>Books I&rsquo;m reading now:</h3>

<ul>
<li>&ldquo;Programming Entity Framework, Second Edition&rdquo; by Julie Lerman - I&rsquo;ve only cherry picked a few sections to read but it looks like it&rsquo;ll be informative. This was recommended to me by a colleague, so I&rsquo;m sure it will be well worth the time I spend with it.</li>
<li>&ldquo;The Girl with the Dragon Tattoo&rdquo; by Stieg Larsson - I read this already, probably about 2 years ago now, but with the movie having been recently released I want to read it another time.</li>
</ul>


<h3>Blog posts I enjoyed:</h3>

<ul>
<li><a href="http://www.hanselman.com/blog/YourBlogIsTheEngineOfCommunity.aspx">http://www.hanselman.com/blog/YourBlogIsTheEngineOfCommunity.aspx</a> - This was just a really great post, good points, and hopefully it inspires all who read it to post more to their blogs.
Then there are these two here that are going to cause me to do some digging around, and the reason I decided I&rsquo;d finally read the Entity Framework book. Did somebody kill off the repository pattern and forget to tell the rest of us?

<ul>
<li><a href="http://www.codethinked.com/keep-your-iqueryable-in-check">http://ayende.com/blog/3955/repository-is-the-new-singleton</a></li>
<li><a href="http://www.codethinked.com/keep-your-iqueryable-in-check">http://www.codethinked.com/keep-your-iqueryable-in-check</a></li>
</ul>
</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/18/object-level-security/">Object Level Security</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-01-18T00:00:00-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>A few weeks ago at work I had the need to provide object level security in a system. I looked around on the web and didn&rsquo;t really see anything other than slight hints at possible solutions to the problem, but nothing really comprehensive. To that end I&rsquo;ve got the following few snippets of code that might help someone else looking to solve a similar problem. I&rsquo;m also going to upload the sample code here as well, but don&rsquo;t expect much more than what you see in the snippets below just yet, but I&rsquo;ll try and build out something more functional in the near future.</p>

<p>First we&rsquo;ll create a few objects. Really we only need two objects for the example to work, and then you can build on that for your own implementation. Let&rsquo;s first define a domain object we might work with in a project, Product.</p>

<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">ProductId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span></code></pre></div>


<p>Not a very helpful object at this point from a business sense, but it will serve the purpose for our simple example. The other important one is the ObjectPermission object which looks something like this.</p>

<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">class</span> <span class="nc">ObjectPermission</span> <span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">ObjectPermissionId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">UserId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="n">GrantType</span> <span class="n">GrantType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="n">AccessType</span> <span class="n">AccessType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Object</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">LimitingField</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">LimitingValue</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span></code></pre></div>


<p>You can look at the example code attached to this post to see what GrantType and AccessType look like. The Object property is just your objects name, so in our example we&rsquo;ll make this &ldquo;Product&rdquo;. The other properties <strong>LimitingField</strong> and <strong>LimitingValue</strong> are there so you can say when a product has a name of x then allow or disallow access to the object. This comes in handy if you have different types of objects and you want a user to only have access to a subset of those.</p>

<p>The real work horse is this next class, the ObjectPermissionEnforcer. An intimidating name, right?</p>

<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">class</span> <span class="nc">ObjectPermissionEnforcer</span> <span class="p">{</span>
    <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">ObjectPermission</span><span class="p">&gt;</span> <span class="n">_permissions</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">ObjectPermissionEnforcer</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">var</span> <span class="n">db</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SampleContext</span><span class="p">();</span>
        <span class="n">_permissions</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">ObjectPermissions</span><span class="p">.</span><span class="n">ToList</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">ObjectPermissionEnforcer</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">ObjectPermission</span><span class="p">&gt;</span> <span class="n">perms</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_permissions</span> <span class="p">=</span> <span class="n">perms</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">SecureList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">secure</span><span class="p">,</span> <span class="n">AccessType</span> <span class="n">accessType</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;();</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">item</span> <span class="k">in</span> <span class="n">secure</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">HasAccess</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">accessType</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">result</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">HasAccess</span><span class="p">(</span><span class="kt">object</span> <span class="n">o</span><span class="p">,</span> <span class="n">AccessType</span> <span class="n">accessType</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_permissions</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">p</span> <span class="p">=&gt;</span> <span class="n">p</span><span class="p">.</span><span class="n">Object</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="s">&quot;All&quot;</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">p</span><span class="p">.</span><span class="n">AccessType</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">accessType</span><span class="p">)).</span><span class="n">FirstOrDefault</span><span class="p">()</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kt">var</span> <span class="n">perms</span> <span class="p">=</span> <span class="n">_permissions</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">p</span> <span class="p">=&gt;</span> <span class="n">p</span><span class="p">.</span><span class="n">Object</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">GetType</span><span class="p">().</span><span class="n">Name</span><span class="p">)).</span><span class="n">ToList</span><span class="p">();</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">IndividualDeny</span><span class="p">(</span><span class="n">perms</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">accessType</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">GlobalPermit</span><span class="p">(</span><span class="n">perms</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">accessType</span><span class="p">)</span> <span class="p">||</span> <span class="n">IndividualPermit</span><span class="p">(</span><span class="n">perms</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">accessType</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="kt">bool</span> <span class="nf">GlobalPermit</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">ObjectPermission</span><span class="p">&gt;</span> <span class="n">perms</span><span class="p">,</span> <span class="kt">object</span> <span class="n">o</span><span class="p">,</span> <span class="n">AccessType</span> <span class="n">accessType</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">accessType</span> <span class="p">==</span> <span class="n">ObjectLevelSecurity</span><span class="p">.</span><span class="n">AccessType</span><span class="p">.</span><span class="n">Write</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">perms</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">p</span> <span class="p">=&gt;</span> <span class="n">p</span><span class="p">.</span><span class="n">GrantType</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">GrantType</span><span class="p">.</span><span class="n">Permit</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">p</span><span class="p">.</span><span class="n">AccessType</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">accessType</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">LimitingField</span><span class="p">)).</span><span class="n">Count</span><span class="p">()</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">perms</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">p</span> <span class="p">=&gt;</span> <span class="n">p</span><span class="p">.</span><span class="n">GrantType</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">GrantType</span><span class="p">.</span><span class="n">Permit</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">LimitingField</span><span class="p">)).</span><span class="n">Count</span><span class="p">()</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="kt">bool</span> <span class="nf">IndividualDeny</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">ObjectPermission</span><span class="p">&gt;</span> <span class="n">perms</span><span class="p">,</span> <span class="kt">object</span> <span class="n">o</span><span class="p">,</span> <span class="n">AccessType</span> <span class="n">accessType</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">var</span> <span class="n">attrPerms</span> <span class="p">=</span> <span class="n">perms</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">p</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">LimitingField</span><span class="p">)</span>
                        <span class="p">&amp;&amp;</span> <span class="n">p</span><span class="p">.</span><span class="n">GrantType</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">GrantType</span><span class="p">.</span><span class="n">Deny</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">p</span><span class="p">.</span><span class="n">AccessType</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">accessType</span><span class="p">)).</span><span class="n">ToList</span><span class="p">();</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">perm</span> <span class="k">in</span> <span class="n">attrPerms</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">GetType</span><span class="p">().</span><span class="n">GetProperty</span><span class="p">(</span><span class="n">perm</span><span class="p">.</span><span class="n">LimitingField</span><span class="p">).</span><span class="n">GetValue</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="k">null</span><span class="p">).</span><span class="n">ToString</span><span class="p">().</span><span class="n">Equals</span><span class="p">(</span><span class="n">perm</span><span class="p">.</span><span class="n">LimitingField</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="kt">bool</span> <span class="nf">IndividualPermit</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">ObjectPermission</span><span class="p">&gt;</span> <span class="n">perms</span><span class="p">,</span> <span class="kt">object</span> <span class="n">o</span><span class="p">,</span> <span class="n">AccessType</span> <span class="n">accessType</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">var</span> <span class="n">attrPerms</span> <span class="p">=</span> <span class="n">perms</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">p</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">LimitingField</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">p</span><span class="p">.</span><span class="n">GrantType</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">GrantType</span><span class="p">.</span><span class="n">Permit</span><span class="p">)).</span><span class="n">ToList</span><span class="p">();</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">perm</span> <span class="k">in</span> <span class="n">attrPerms</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">accessType</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">ObjectLevelSecurity</span><span class="p">.</span><span class="n">AccessType</span><span class="p">.</span><span class="n">Write</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">GetType</span><span class="p">().</span><span class="n">GetProperty</span><span class="p">(</span><span class="n">perm</span><span class="p">.</span><span class="n">LimitingField</span><span class="p">).</span><span class="n">GetValue</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="k">null</span><span class="p">).</span><span class="n">ToString</span><span class="p">().</span><span class="n">Equals</span><span class="p">(</span><span class="n">perm</span><span class="p">.</span><span class="n">LimitingValue</span><span class="p">)</span>
                    <span class="p">&amp;&amp;</span> <span class="n">perm</span><span class="p">.</span><span class="n">AccessType</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">accessType</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">GetType</span><span class="p">().</span><span class="n">GetProperty</span><span class="p">(</span><span class="n">perm</span><span class="p">.</span><span class="n">LimitingField</span><span class="p">).</span><span class="n">GetValue</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="k">null</span><span class="p">).</span><span class="n">ToString</span><span class="p">().</span><span class="n">Equals</span><span class="p">(</span><span class="n">perm</span><span class="p">.</span><span class="n">LimitingValue</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>


<p>This hopefully isn&rsquo;t too intimidating. Keep in mind that this enforcer assumes you must be explicitly granted permissions to something before you&rsquo;ll be able to see it. For that reason the &ldquo;All&rdquo; check exists so you can grant access to administrators on everything in your system. The other important bit about this is the SecureList() method. Slapping this code in your project won&rsquo;t magically secure up everything, you actually have to pass a list through the enforcer, which you can think of as a filter. The objects that come out the other end are those the user can view.</p>

<p>And finally we have a very basic implementation of this.</p>

<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">products</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Product</span><span class="p">&gt;();</span>
<span class="n">products</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Product</span><span class="p">()</span> <span class="p">{</span><span class="n">ProductId</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;First&quot;</span><span class="p">});</span>
<span class="n">products</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Product</span><span class="p">()</span> <span class="p">{</span><span class="n">ProductId</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Second&quot;</span><span class="p">});</span>

<span class="kt">var</span> <span class="n">perms</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">ObjectPermission</span><span class="p">&gt;();</span>

<span class="n">perms</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">ObjectPermission</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ObjectPermissionId</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
    <span class="n">UserId</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
    <span class="n">GrantType</span> <span class="p">=</span> <span class="n">ObjectLevelSecurity</span><span class="p">.</span><span class="n">GrantType</span><span class="p">.</span><span class="n">Permit</span><span class="p">,</span>
    <span class="n">AccessType</span> <span class="p">=</span> <span class="n">ObjectLevelSecurity</span><span class="p">.</span><span class="n">AccessType</span><span class="p">.</span><span class="n">Read</span><span class="p">,</span>
    <span class="n">Object</span> <span class="p">=</span> <span class="s">&quot;Product&quot;</span><span class="p">,</span>
    <span class="n">LimitingField</span> <span class="p">=</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span>
    <span class="n">LimitingValue</span> <span class="p">=</span> <span class="s">&quot;Second&quot;</span>
<span class="p">});</span>

<span class="kt">var</span> <span class="n">enforcer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectPermissionEnforcer</span><span class="p">(</span><span class="n">perms</span><span class="p">);</span>
 
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Read Access:&quot;</span><span class="p">);</span>
<span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">p</span> <span class="k">in</span> <span class="n">enforcer</span><span class="p">.</span><span class="n">SecureList</span><span class="p">&lt;</span><span class="n">Product</span><span class="p">&gt;(</span><span class="n">products</span><span class="p">,</span> <span class="n">AccessType</span><span class="p">.</span><span class="n">Read</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">();</span>

<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Write Access:&quot;</span><span class="p">);</span>
<span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">p</span> <span class="k">in</span> <span class="n">enforcer</span><span class="p">.</span><span class="n">SecureList</span><span class="p">&lt;</span><span class="n">Product</span><span class="p">&gt;(</span><span class="n">products</span><span class="p">,</span> <span class="n">AccessType</span><span class="p">.</span><span class="n">Write</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">();</span></code></pre></div>


<p>Basically I setup a single permission for a user granting them read access to products that have a name of &ldquo;Second&rdquo;.</p>

<p>If you want to use this in the real world you&rsquo;ll certainly have to extend a few things. I had really wanted to put together an example complete with a database schema for you but I forgot Entity Framework doesn&rsquo;t currently support enums. After I realized, I mean remembered, that, I sort of gave up on that. You can see though that you could grab the permissions for the current user from your persistence layer, push those into the enforcer, and then secure whatever you like. Something you might want to do is create some extension methods, perhaps extending object or maybe you have a MyObjectBase type class that all your other classes inherit from. That way you can verify object very easily one object at a time.</p>

<p>And that&rsquo;s the show for today. I hope you enjoyed it, and we&rsquo;ll see you back here real soon! Right?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/12/20/selectfor-helper/">SelectFor Helper</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-12-20T00:00:00-05:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I got a little tired of having to convert things into lists of SelectListItem. Unless I&rsquo;m missing something with how Microsoft intended you to use Html.DropDownListFor that is. Instead I threw together the following.</p>

<div class="highlight"><pre><code class="language-vbnet" data-lang="vbnet"><span class="na">&lt;Extension()&gt;</span> <span class="n">_</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">SelectFor</span><span class="p">(</span><span class="k">Of</span> <span class="n">TModel</span><span class="p">,</span> <span class="n">TValue</span><span class="p">)(</span><span class="k">ByVal</span> <span class="n">helper</span> <span class="ow">As</span> <span class="n">HtmlHelper</span><span class="p">(</span><span class="k">Of</span> <span class="n">TModel</span><span class="p">),</span> <span class="n">_</span>
                                                 <span class="k">ByVal</span> <span class="n">expression</span> <span class="ow">As</span> <span class="n">Expression</span><span class="p">(</span><span class="k">Of</span> <span class="n">Func</span><span class="p">(</span><span class="k">Of</span> <span class="n">TModel</span><span class="p">,</span> <span class="n">TValue</span><span class="p">)),</span> <span class="n">_</span>
                                                 <span class="k">ByVal</span> <span class="n">options</span> <span class="ow">As</span> <span class="n">IList</span><span class="p">,</span>
                                                 <span class="k">ByVal</span> <span class="n">textField</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span>
                                                 <span class="k">ByVal</span> <span class="n">valueField</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span>
                                                 <span class="k">Optional</span> <span class="k">ByVal</span> <span class="n">includeBlank</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span><span class="p">)</span> <span class="ow">As</span> <span class="n">MvcHtmlString</span>
 
        <span class="k">Dim</span> <span class="n">metaData</span> <span class="ow">As</span> <span class="n">ModelMetadata</span> <span class="o">=</span> <span class="n">ModelMetadata</span><span class="p">.</span><span class="n">FromLambdaExpression</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">helper</span><span class="p">.</span><span class="n">ViewData</span><span class="p">)</span>
        <span class="k">Dim</span> <span class="n">textWriter</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">StringWriter</span><span class="p">()</span>
 
        <span class="k">Using</span> <span class="n">writer</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">HtmlTextWriter</span><span class="p">(</span><span class="n">textWriter</span><span class="p">)</span>
 
            <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="n">HtmlTextWriterAttribute</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">helper</span><span class="p">.</span><span class="n">ViewContext</span><span class="p">.</span><span class="n">ViewData</span><span class="p">.</span><span class="n">TemplateInfo</span><span class="p">.</span><span class="n">GetFullHtmlFieldId</span><span class="p">(</span><span class="n">ExpressionHelper</span><span class="p">.</span><span class="n">GetExpressionText</span><span class="p">(</span><span class="n">expression</span><span class="p">)))</span>
            <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="n">HtmlTextWriterAttribute</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">helper</span><span class="p">.</span><span class="n">ViewContext</span><span class="p">.</span><span class="n">ViewData</span><span class="p">.</span><span class="n">TemplateInfo</span><span class="p">.</span><span class="n">GetFullHtmlFieldName</span><span class="p">(</span><span class="n">ExpressionHelper</span><span class="p">.</span><span class="n">GetExpressionText</span><span class="p">(</span><span class="n">expression</span><span class="p">)))</span>
            <span class="n">writer</span><span class="p">.</span><span class="n">RenderBeginTag</span><span class="p">(</span><span class="n">HtmlTextWriterTag</span><span class="p">.</span><span class="n">Select</span><span class="p">)</span>
 
            <span class="k">If</span> <span class="n">includeBlank</span> <span class="k">Then</span>
                <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="n">HtmlTextWriterAttribute</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
                <span class="n">writer</span><span class="p">.</span><span class="n">RenderBeginTag</span><span class="p">(</span><span class="n">HtmlTextWriterTag</span><span class="p">.</span><span class="n">Option</span><span class="p">)</span>
                <span class="n">writer</span><span class="p">.</span><span class="n">RenderEndTag</span><span class="p">()</span>
            <span class="k">End</span> <span class="k">If</span>
 
            <span class="k">If</span> <span class="n">options</span> <span class="ow">IsNot</span> <span class="k">Nothing</span> <span class="k">Then</span>
                <span class="k">For</span> <span class="k">Each</span> <span class="n">item</span> <span class="ow">In</span> <span class="n">options</span>
                    <span class="k">If</span> <span class="n">metaData</span><span class="p">.</span><span class="n">Model</span> <span class="o">=</span> <span class="n">item</span><span class="p">.</span><span class="n">GetType</span><span class="p">.</span><span class="n">GetProperty</span><span class="p">(</span><span class="n">valueField</span><span class="p">).</span><span class="n">GetValue</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="k">Nothing</span><span class="p">)</span> <span class="k">Then</span>
                        <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="n">HtmlTextWriterAttribute</span><span class="p">.</span><span class="n">Selected</span><span class="p">,</span> <span class="s">&quot;selected&quot;</span><span class="p">)</span>
                    <span class="k">End</span> <span class="k">If</span>
 
                    <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="n">HtmlTextWriterAttribute</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="n">GetType</span><span class="p">.</span><span class="n">GetProperty</span><span class="p">(</span><span class="n">valueField</span><span class="p">).</span><span class="n">GetValue</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="k">Nothing</span><span class="p">))</span>
                    <span class="n">writer</span><span class="p">.</span><span class="n">RenderBeginTag</span><span class="p">(</span><span class="n">HtmlTextWriterTag</span><span class="p">.</span><span class="n">Option</span><span class="p">)</span>
                    <span class="n">writer</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">GetType</span><span class="p">.</span><span class="n">GetProperty</span><span class="p">(</span><span class="n">textField</span><span class="p">).</span><span class="n">GetValue</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="k">Nothing</span><span class="p">))</span>
                    <span class="n">writer</span><span class="p">.</span><span class="n">RenderEndTag</span><span class="p">()</span>
                <span class="k">Next</span>
            <span class="k">End</span> <span class="k">If</span>
 
            <span class="n">writer</span><span class="p">.</span><span class="n">RenderEndTag</span><span class="p">()</span>
        <span class="k">End</span> <span class="k">Using</span>
 
        <span class="k">Return</span> <span class="n">MvcHtmlString</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">textWriter</span><span class="p">.</span><span class="n">ToString</span><span class="p">())</span>
    <span class="k">End</span> <span class="k">Function</span></code></pre></div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/24/unit-testing-and-tdd-make-me-better/">Unit Testing and TDD Make Me Better</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-11-24T00:00:00-05:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>That&rsquo;s right, and here I&rsquo;ll tell you why I&rsquo;m saying this.</p>

<p>Yesterday I went through a massive refactoring of code and came out very concerned about the changes I made. To be perfectly honest it was a 4 or 5 hour hack fest, during which I slashed code in places, factored out interfaces, created extension methods in an effort to have very simple domain objects, and on and on. Then I removed my hands from the keyboard, wiped the sweat from my brow, and then began to panic. I started the project very strong in my convictions; the code was a mess and it needed to be corrected. That was yesterday.</p>

<p>A day later, a good nights sleep, and some deep reflection and I&rsquo;m sure of two things. First, yeah, the code is a mess and that needs to be corrected. Second, I went about it entirely the wrong way. Here&rsquo;s why I say that.</p>

<p>Like I said, when I got done slashing and hacking away at the code yesterday I was already beginning to have my doubts. On the drive home the headaches that I potentially created started to loom in my thoughts. All that time I was cutting through the code and never once did I stop to check my work. Hell, it wasn&rsquo;t until the last 20 minutes of the effort that I was able to successfully compile the code, and as we know a successful build is not an indication of working code. So last night, more than a little concerned, I finally start looking at fixing up the unit tests.</p>

<p>Oh, hold on here a second. I should have told you that this entire effort was embarked upon in the interest of making the code more modular and testable. It was functional enough before I started making these changes, except that the design did not lend itself well to unit testing at all, and lately I&rsquo;m all about writing more testable code. Isn&rsquo;t it ironic though that throughout this effort I didn&rsquo;t allow my tests to dictate my code refactoring. Let&rsquo;s just say lesson learned.</p>

<p>Perhaps that is the end of it for now. I&rsquo;ll leave things by apologizing to Stephen Covey, author of &ldquo;The 7 Habits of Highly Effective People&rdquo;. One of those habits is to &ldquo;begin with the end in mind&rdquo;. Well, I sort of did that. I knew what I wanted to accomplish, and I wanted to hit that goal as soon as possible. If I had bothered to think about it for even a few minutes I would most likely have done things differently. The second person I owe an apology to is Roy Osherove, author of &ldquo;The Art of Unit Testing&rdquo;, which I have actually been reading lately. Man did I mess this one up.</p>

<p>What am I doing now? Well, I&rsquo;m going to hit the undo button, literally, and back out all my changes. Then I&rsquo;ll start again, but this time I will allow the unit tests to drive the refactor. Oh, and yeah, I guess maybe I&rsquo;ll do a bit of integration testing along the way.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/08/why-not-pay-what-you-can/">Why Not Pay What You Can?</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-11-08T00:00:00-05:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;m a huge fan of internet based tools. At the same time, I&rsquo;m also a huge fan of paying for the things I use on a daily basis, such as these internet services. I have a <a href="http://www.spotify.com/">Spotify</a> account which feeds all my music listening needs. I used to buy the odd album here and there, or occasionally pick up a track from iTunes, but lately I have preferred to pay a flat fee for this service which allows me to take music offline on multiple devices. So far I also haven&rsquo;t had any real complaints. Another service I use is <a href="http://www.evernote.com/">Evernote</a>, which is an online notebook system, very similar to OneNote from Microsoft if you are familiar with that. The thing that gets me with this service, and some others but I&rsquo;ll use this as an example, is that their free for use service provides more than enough functionality for the casual user such as myself to never have to worry about anything more than this advertisement driven version. What makes even less sense is that the ads they display aren&rsquo;t even intrusive, but rather blend very naturally into the overall application interface so you don&rsquo;t hardly even notice them. That being the case, what would compel a user such as myself to pay the monthly service fee? To me it seems like services like this one are missing out on a potential revenue stream, but maybe I&rsquo;m the odd man out on this one.</p>

<p>My question quite simply is this. Would you opt to pay what you could if you were allowed to do so?</p>

<p>I don&rsquo;t know exactly what the model would look like. Maybe you could subscribe for one time donations to the project. Another model might allow you to choose how much you would like billed monthly and setup recurring payments to be automatically charged to a credit card. To me, for my piece of mind, and knowing what goes into building these services, I certainly would.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/09/28/tinymce-in-jquery-dialog/">TinyMCE in jQuery Dialog</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-09-28T00:00:00-04:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve been using TinyMCE lately as a WYSIWYG HTML editor and so far do not have any complaints. I did encounter an interesting problem the other day though that I was able to get resolved with the bit of code I&rsquo;ll include here. I hope it helps you out.</p>

<p>The problem was simple, I wanted to render the contents of a view through an AJAX call into a JQuery Dialog. This was necessary because the view I wanted to load might change based on the specific type of item I was displaying the form for, and I didn&rsquo;t want to handle all those conditional checks on the client-side so that I wouldn&rsquo;t overwhelm my user with unnecessary form fields. The challenge was that in certain cases I wanted the TinyMCE editor to display. The issue I encountered was that the textarea wasn&rsquo;t being TinyMCE'ified when the $.load() completed. The following bit of code should illustrate a way to get around this.</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">doTextEditor</span><span class="p">(</span><span class="nx">contentType</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div /&gt;&#39;</span><span class="p">).</span><span class="nx">dialog</span><span class="p">({</span> <span class="nx">width</span><span class="o">:</span> <span class="mi">700</span><span class="p">,</span> <span class="nx">height</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span> <span class="nx">modal</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}).</span><span class="nx">load</span><span class="p">(</span><span class="s1">&#39;/moduleinstance/createcontent&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">contentType</span><span class="o">:</span> <span class="nx">contentType</span> <span class="p">},</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">tinyMCE</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
      <span class="nx">mode</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
      <span class="nx">theme</span><span class="o">:</span> <span class="s1">&#39;advanced&#39;</span><span class="p">,</span>
      <span class="nx">height</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
      <span class="nx">width</span><span class="o">:</span> <span class="mi">700</span><span class="p">,</span>
      <span class="nx">theme_advanced_buttons1</span><span class="o">:</span> <span class="s1">&#39;forecolor, |, justifyleft, justifyright, justifycenter, justifyfull, |, bold, italic, underline, |, bullist, numlist, |, code&#39;</span><span class="p">,</span>
      <span class="nx">theme_advanced_buttons2</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="nx">theme_advanced_buttons3</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="nx">plugins</span><span class="o">:</span> <span class="s1">&#39;paste&#39;</span>
    <span class="p">});</span>

    <span class="nx">tinyMCE</span><span class="p">.</span><span class="nx">execCommand</span><span class="p">(</span><span class="s1">&#39;mceAddControl&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="s1">&#39;TextContent&#39;</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span></code></pre></div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/09/28/htmlselectforenum-extension-for-mvc/">Html.SelectForEnum Extension for MVC</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-09-28T00:00:00-04:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I was surprised not to find this in the arsenal of extension methods for ASP.Net MVC. The code snippet below is an extension method that you can use to display a select box of options corresponding to a property on your model that is of an Enum type. This way everything happens for you, and if your values ever change you only have to worry about updating the Enum itself, and not everywhere you have it exposed in the UI.</p>

<div class="highlight"><pre><code class="language-vbnet" data-lang="vbnet"><span class="na">&lt;Extension()&gt;</span> <span class="n">_</span>
<span class="k">Public</span> <span class="k">Function</span> <span class="nf">SelectForEnum</span><span class="p">(</span><span class="k">Of</span> <span class="n">TModel</span><span class="p">,</span> <span class="n">TValue</span><span class="p">)(</span><span class="k">ByVal</span> <span class="n">helper</span> <span class="ow">As</span> <span class="n">HtmlHelper</span><span class="p">(</span><span class="k">Of</span> <span class="n">TModel</span><span class="p">),</span> <span class="n">_</span>
             <span class="k">ByVal</span> <span class="n">expression</span> <span class="ow">As</span> <span class="n">Expression</span><span class="p">(</span><span class="k">Of</span> <span class="n">Func</span><span class="p">(</span><span class="k">Of</span> <span class="n">TModel</span><span class="p">,</span> <span class="n">TValue</span><span class="p">)),</span> <span class="n">_</span>
             <span class="k">Optional</span> <span class="k">ByVal</span> <span class="n">includeBlank</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span><span class="p">)</span> <span class="ow">As</span> <span class="n">MvcHtmlString</span>
 
 <span class="k">Dim</span> <span class="n">metaData</span> <span class="ow">As</span> <span class="n">ModelMetadata</span> <span class="o">=</span> <span class="n">ModelMetadata</span><span class="p">.</span><span class="n">FromLambdaExpression</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">helper</span><span class="p">.</span><span class="n">ViewData</span><span class="p">)</span>
 <span class="k">Dim</span> <span class="n">names</span> <span class="o">=</span> <span class="err">[</span><span class="n">Enum</span><span class="err">]</span><span class="p">.</span><span class="n">GetNames</span><span class="p">(</span><span class="n">metaData</span><span class="p">.</span><span class="n">ModelType</span><span class="p">)</span>
 <span class="k">Dim</span> <span class="n">textWriter</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">StringWriter</span><span class="p">()</span>
 <span class="k">Dim</span> <span class="n">fieldName</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="n">ViewContext</span><span class="p">.</span><span class="n">ViewData</span><span class="p">.</span><span class="n">TemplateInfo</span><span class="p">.</span><span class="n">GetFullHtmlFieldName</span><span class="p">(</span><span class="n">ExpressionHelper</span><span class="p">.</span><span class="n">GetExpressionText</span><span class="p">(</span><span class="n">expression</span><span class="p">))</span>
 
 <span class="k">Using</span> <span class="n">writer</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">HtmlTextWriter</span><span class="p">(</span><span class="n">textWriter</span><span class="p">)</span>
 
  <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="n">HtmlTextWriterAttribute</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">fieldName</span><span class="p">)</span>
  <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="n">HtmlTextWriterAttribute</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">fieldName</span><span class="p">)</span>
  <span class="n">writer</span><span class="p">.</span><span class="n">RenderBeginTag</span><span class="p">(</span><span class="n">HtmlTextWriterTag</span><span class="p">.</span><span class="n">Select</span><span class="p">)</span>
 
  <span class="k">If</span> <span class="n">includeBlank</span> <span class="k">Then</span>
   <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="n">HtmlTextWriterAttribute</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
   <span class="n">writer</span><span class="p">.</span><span class="n">RenderBeginTag</span><span class="p">(</span><span class="n">HtmlTextWriterTag</span><span class="p">.</span><span class="n">Option</span><span class="p">)</span>
   <span class="n">writer</span><span class="p">.</span><span class="n">RenderEndTag</span><span class="p">()</span>
  <span class="k">End</span> <span class="k">If</span>
 
  <span class="k">For</span> <span class="k">Each</span> <span class="n">item</span> <span class="ow">In</span> <span class="err">[</span><span class="n">Enum</span><span class="err">]</span><span class="p">.</span><span class="n">GetValues</span><span class="p">(</span><span class="n">metaData</span><span class="p">.</span><span class="n">ModelType</span><span class="p">)</span>
   <span class="k">Dim</span> <span class="n">enumName</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="err">[</span><span class="n">Enum</span><span class="err">]</span><span class="p">.</span><span class="n">GetName</span><span class="p">(</span><span class="n">metaData</span><span class="p">.</span><span class="n">ModelType</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
 
   <span class="k">If</span> <span class="n">metaData</span><span class="p">.</span><span class="n">Model</span> <span class="o">=</span> <span class="n">item</span> <span class="k">Then</span>
    <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="n">HtmlTextWriterAttribute</span><span class="p">.</span><span class="n">Selected</span><span class="p">,</span> <span class="s">&quot;selected&quot;</span><span class="p">)</span>
   <span class="k">End</span> <span class="k">If</span>
 
   <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="s">&quot;enum-name&quot;</span><span class="p">,</span> <span class="n">enumName</span><span class="p">)</span>
   <span class="n">writer</span><span class="p">.</span><span class="n">AddAttribute</span><span class="p">(</span><span class="n">HtmlTextWriterAttribute</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
   <span class="n">writer</span><span class="p">.</span><span class="n">RenderBeginTag</span><span class="p">(</span><span class="n">HtmlTextWriterTag</span><span class="p">.</span><span class="n">Option</span><span class="p">)</span>
   <span class="n">writer</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">enumName</span><span class="p">)</span>
   <span class="n">writer</span><span class="p">.</span><span class="n">RenderEndTag</span><span class="p">()</span>
  <span class="k">Next</span>
 
  <span class="n">writer</span><span class="p">.</span><span class="n">RenderEndTag</span><span class="p">()</span>
 <span class="k">End</span> <span class="k">Using</span>
 
 <span class="k">Return</span> <span class="n">MvcHtmlString</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">textWriter</span><span class="p">.</span><span class="n">ToString</span><span class="p">())</span>
<span class="k">End</span> <span class="k">Function</span></code></pre></div>


<p>As always I hope you find this useful.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/5">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/3">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Brad Teller -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace">Whitespace</a></span>
</p>

</footer>
  






<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
