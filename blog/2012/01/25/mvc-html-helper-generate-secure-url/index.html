
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>MVC Html Helper: Generate Secure URL - Brad Teller</title>
  <meta name="author" content="Brad Teller">

  
  <meta name="description" content="Have you ever wanted to generate action links to your controller and have them be prefixed with the correct protocol? This was missing from the core &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://bradteller.com/blog/2012/01/25/mvc-html-helper-generate-secure-url/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Brad Teller" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Brad Teller</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="bradteller.com">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">MVC Html Helper: Generate Secure URL</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-01-25T00:00:00-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Have you ever wanted to generate action links to your controller and have them be prefixed with the correct protocol? This was missing from the core set of extensions, at least from my poking around. I&rsquo;m not sure if I should have taken it&rsquo;s absence as an indication that perhaps there is another approach that should be taken. We&rsquo;ve all been told since the beginning that SSL communications should be reserved for times when encrypted communications is an absolute requirement, such as when authenticating a user, displaying a customers banking information, or accepting a payment method. While there is always going to be some level of overhead to these communications, in some situations it may be negligible.</p>

<p>Regardless of that the requirement here is quite clear. I have action methods on my controller that I&rsquo;m decorating with the RequireHttps attribute. When I create the equivalent of an Html.ActionLink to them I want the protocol to be automatically specified correctly, that way secure pages will be routed of HTTPS. The following is an extension method to help make life a little easier dealing with that requirement.</p>

<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">static</span> <span class="n">MvcHtmlString</span> <span class="nf">GenerateUrl</span><span class="p">(</span><span class="k">this</span> <span class="n">HtmlHelper</span> <span class="n">helper</span><span class="p">,</span> <span class="kt">string</span> <span class="n">linkText</span><span class="p">,</span> <span class="kt">string</span> <span class="n">actionName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">controllerName</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="n">protocol</span> <span class="p">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>

    <span class="kt">var</span> <span class="n">c</span> <span class="p">=</span> <span class="n">ControllerBuilder</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">GetControllerFactory</span><span class="p">().</span><span class="n">CreateController</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="n">ViewContext</span><span class="p">.</span><span class="n">RequestContext</span><span class="p">,</span> <span class="n">controllerName</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">cd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ReflectedControllerDescriptor</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">GetType</span><span class="p">());</span>
    <span class="kt">var</span> <span class="n">ad</span> <span class="p">=</span> <span class="n">cd</span><span class="p">.</span><span class="n">FindAction</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="n">ViewContext</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">ControllerContext</span><span class="p">,</span> <span class="n">actionName</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ad</span><span class="p">.</span><span class="n">GetCustomAttributes</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">RequireHttpsAttribute</span><span class="p">),</span> <span class="k">false</span><span class="p">).</span><span class="n">Count</span><span class="p">()</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">protocol</span> <span class="p">=</span> <span class="s">&quot;https&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">helper</span><span class="p">.</span><span class="n">ActionLink</span><span class="p">(</span><span class="n">linkText</span><span class="p">,</span> <span class="n">actionName</span><span class="p">,</span> <span class="n">controllerName</span><span class="p">,</span> <span class="n">protocol</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Brad Teller</span></span>

      




<time class='entry-date' datetime='2012-01-25T00:00:00-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://bradteller.com/blog/2012/01/25/mvc-html-helper-generate-secure-url/" data-via="bradteller" data-counturl="http://bradteller.com/blog/2012/01/25/mvc-html-helper-generate-secure-url/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/01/20/programming-nightmares/" title="Previous Post: Programming Nightmares">&laquo; Programming Nightmares</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/02/15/the-weekly-bookshelf/" title="Next Post: The Weekly Bookshelf">The Weekly Bookshelf &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/07/01/responsive-now/">Start Planning for Responsive Design, NOW!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/15/pdiff-the-right-way/">Perceptual Differencing, the Right Way!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/02/tfs-build-getting-better/">TFS Build Might Be Getting Better</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/16/maybe-oneget-is-for/">Maybe I Know What OneGet Is For</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/11/what-is-oneget/">OneGet... What For?</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/bteller">@bteller</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'bteller',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Brad Teller -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
